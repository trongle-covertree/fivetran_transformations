{{ config(materialized='table') }}

SELECT 
	EXPOSURE_CHARACTERISTICS_LOCATOR,
	POLICY_LOCATOR,
	EXPOSURE_LOCATOR,
	ACTIVE_POLICY_FLAG,
	CASE WHEN COUNTRY IS NULL THEN 'No' else COUNTRY END                                                           AS COUNTRY,
	CASE WHEN STATE IS NULL THEN 'No' else STATE END                                                               AS STATE,
	CASE WHEN STREET_ADDRESS IS NULL THEN 'No' else STREET_ADDRESS END                                             AS STREET_ADDRESS,
	CASE WHEN ZIP_CODE IS NULL THEN 'No' else ZIP_CODE END                                                         AS ZIP_CODE,
	CASE WHEN CITY IS NULL THEN 'No' else CITY END                                                                 AS CITY,
	CASE WHEN COUNTY IS NULL THEN 'No' else COUNTY END                                                             AS COUNTY,
	CASE WHEN TERRITORY IS NULL THEN 'No' else TERRITORY END                                                       AS TERRITORY,
	CASE WHEN LONG IS NULL THEN 'No' else LONG END                                                                 AS LONG,
	CASE WHEN TERRITORY_CODE_AOP IS NULL THEN 'No' else TERRITORY_CODE_AOP END                                     AS TERRITORY_CODE_AOP,
	CASE WHEN PROPERTY_WITH_FIRE_PROTECTION IS NULL THEN 'No' else PROPERTY_WITH_FIRE_PROTECTION END               AS PROPERTY_WITH_FIRE_PROTECTION,
	CASE WHEN POLICY_USAGE IS NULL THEN 'No' else POLICY_USAGE END                                                 AS POLICY_USAGE,
	CASE WHEN TERRITORY_CODE_WINDHAIL IS NULL THEN 'No' else TERRITORY_CODE_WINDHAIL END                           AS TERRITORY_CODE_WINDHAIL,
	CASE WHEN LAT IS NULL THEN 'No' else LAT END                                                                   AS LAT,
	CASE WHEN TERRITORY_CODE_EARTHQUAKE IS NULL THEN 'No' else TERRITORY_CODE_EARTHQUAKE END                       AS TERRITORY_CODE_EARTHQUAKE,
	CASE WHEN UNIT_DETAILS IS NULL THEN 'No' else UNIT_DETAILS END                                                 AS UNIT_DETAILS,
	CASE WHEN USAGE IS NULL THEN 'No' else USAGE END                                                               AS USAGE,
	CASE WHEN BUSINESS_ON_PREMISES IS NULL THEN 'No' else BUSINESS_ON_PREMISES END                                 AS BUSINESS_ON_PREMISES,
	CASE WHEN GRID_ID IS NULL THEN 'No' else GRID_ID END                                                           AS GRID_ID,
	CASE WHEN UW_ADMITTED IS NULL THEN 'No' else UW_ADMITTED END                                                   AS UW_ADMITTED,
	CASE WHEN FORM IS NULL THEN 'No' else FORM END                                                                 AS FORM,
	CASE WHEN UNIT_LEVEL_SUPPL_UW IS NULL THEN 'No' else UNIT_LEVEL_SUPPL_UW END                                   AS UNIT_LEVEL_SUPPL_UW,
	CASE WHEN VALUATION_ID IS NULL THEN 'No' else VALUATION_ID END                                                 AS VALUATION_ID,
	CASE WHEN UNIT_ADDRESS IS NULL THEN 'No' else UNIT_ADDRESS END                                                 AS UNIT_ADDRESS,
	CASE WHEN UNIT_ID IS NULL THEN 'No' else UNIT_ID END                                                           AS UNIT_ID,
	CASE WHEN COMMUNITY_POLICY_DISCOUNT IS NULL THEN 'No' else COMMUNITY_POLICY_DISCOUNT END                       AS COMMUNITY_POLICY_DISCOUNT,
	CASE WHEN UNIT_LOCATION IS NULL THEN 'No' else UNIT_LOCATION END                                               AS UNIT_LOCATION,
	CASE WHEN LOC_CODE IS NULL THEN 'No' else LOC_CODE END                                                         AS LOC_CODE,
	CASE WHEN PERSONALIZED_PLAN_TYPE IS NULL THEN 'No' else PERSONALIZED_PLAN_TYPE END                             AS PERSONALIZED_PLAN_TYPE,
	CASE WHEN UNIT_CONSTRUCTION IS NULL THEN 'No' else UNIT_CONSTRUCTION END                                       AS UNIT_CONSTRUCTION,
	CASE WHEN HOME_TYPE IS NULL THEN 'No' else HOME_TYPE END                                                       AS HOME_TYPE,
	CASE WHEN ROOF_SHAPE IS NULL THEN 'No' else ROOF_SHAPE END                                                     AS ROOF_SHAPE,
	CASE WHEN SOURCE_OF_HEAT IS NULL THEN 'No' else SOURCE_OF_HEAT END                                             AS SOURCE_OF_HEAT,
	CASE WHEN ROOF_CONDITION IS NULL THEN 'Unknown' else ROOF_CONDITION END                                        AS ROOF_CONDITION,
	CASE WHEN MODEL_YEAR IS NULL THEN 'No' else MODEL_YEAR END                                                     AS MODEL_YEAR,
	CASE WHEN RCV IS NULL THEN 'No' else RCV END                                                                   AS RCV,
	CASE WHEN SWIMMING_POOL IS NULL THEN 'No' else SWIMMING_POOL END                                               AS SWIMMING_POOL,
	CASE WHEN MORTGAGE IS NULL THEN 'No' else MORTGAGE END                                                         AS MORTGAGE,
	CASE WHEN MANUFACTURER_NAME IS NULL THEN 'No' else MANUFACTURER_NAME END                                       AS MANUFACTURER_NAME,
	CASE WHEN TOTAL_SQUARE_FOOTAGE IS NULL THEN 'No' else TOTAL_SQUARE_FOOTAGE END                                 AS TOTAL_SQUARE_FOOTAGE,
	CASE WHEN UNREPAIRED_DAMAGES IS NULL THEN 'No' else UNREPAIRED_DAMAGES END                                     AS UNREPAIRED_DAMAGES,
	CASE WHEN TRAMPOLINE_LIABILITY IS NULL THEN 'No' else TRAMPOLINE_LIABILITY END                                 AS TRAMPOLINE_LIABILITY,
	CASE WHEN EXTERIOR IS NULL THEN 'No' else EXTERIOR END                                                         AS EXTERIOR,
	CASE WHEN ROOF_YEAR_YYYY IS NULL THEN 'No' else ROOF_YEAR_YYYY END                                             AS ROOF_YEAR_YYYY,
	CASE WHEN SECURE_RAILS IS NULL THEN 'No' else SECURE_RAILS END                                                 AS SECURE_RAILS,
	CASE WHEN INTERIOR IS NULL THEN 'No' else INTERIOR END                                                         AS INTERIOR,
	CASE WHEN ACV IS NULL THEN 'No' else ACV END                                                                   AS ACV,
	CASE WHEN UTILITY_SERVICES IS NULL THEN 'No' else UTILITY_SERVICES END                                         AS UTILITY_SERVICES,
	CASE WHEN INSPECTIONS IS NULL THEN 'No' else INSPECTIONS END                                                   AS INSPECTIONS,
	CASE WHEN THERMO_STATIC_CONTROL IS NULL THEN 'No' else THERMO_STATIC_CONTROL END                               AS THERMO_STATIC_CONTROL,
	CASE WHEN UNIT_IS_TIED IS NULL THEN 'No' else UNIT_IS_TIED END                                                 AS UNIT_IS_TIED,
	CASE WHEN AERIAL IS NULL THEN 'No' else AERIAL END                                                             AS AERIAL,
	CASE WHEN HOME_FIXTURES IS NULL THEN 'No' else HOME_FIXTURES END                                               AS HOME_FIXTURES,
	CASE WHEN ROOF_MATERIAL IS NULL THEN 'Unknown' else ROOF_MATERIAL END                                          AS ROOF_MATERIAL,
	CASE WHEN COUNTY_FIPS IS NULL THEN 'No' else COUNTY_FIPS END                                                   AS COUNTY_FIPS,
	CASE WHEN UNUSUAL_RISK IS NULL THEN 'No' else UNUSUAL_RISK END                                                 AS UNUSUAL_RISK,
	CASE WHEN DISTANCE_TO_COAST IS NULL THEN 'No' else DISTANCE_TO_COAST END                                       AS DISTANCE_TO_COAST,
	CASE WHEN RCV_360VALUE IS NULL THEN 'No' else RCV_360VALUE END                                                 AS RCV_360VALUE,
	CASE WHEN PARK_NAME IS NULL THEN 'No' else PARK_NAME END                                                       AS PARK_NAME,
	CASE WHEN LOT_UNIT IS NULL THEN 'No' else LOT_UNIT END                                                         AS LOT_UNIT,
	CASE WHEN PURCHASE_DATE IS NULL THEN 'No' else PURCHASE_DATE END                                               AS PURCHASE_DATE,
	CASE WHEN CT_MHCID IS NULL THEN 'No' else CT_MHCID END                                                         AS CT_MHCID,
	CASE WHEN ADDITIONAL_INTEREST IS NULL THEN 'No' else ADDITIONAL_INTEREST END                                   AS ADDITIONAL_INTEREST,
	CASE WHEN NAME IS NULL THEN 'No' else NAME END                                                                 AS NAME,
	CASE WHEN TYPE IS NULL THEN 'No' else TYPE END                                                                 AS TYPE,
	CASE WHEN ADDITIONAL_INTEREST_ID IS NULL THEN 'No' else ADDITIONAL_INTEREST_ID END                             AS ADDITIONAL_INTEREST_ID,
	CASE WHEN ROOF_RATING_IMAGE_LINK IS NULL THEN 'No' else ROOF_RATING_IMAGE_LINK END                             AS ROOF_RATING_IMAGE_LINK,
	CASE WHEN ACCOUNT_NUMBER IS NULL THEN 'No' else ACCOUNT_NUMBER END                                             AS ACCOUNT_NUMBER,
	CASE WHEN BURGLAR_ALARM IS NULL THEN 'No' else BURGLAR_ALARM END                                               AS BURGLAR_ALARM,
	CASE WHEN TERRITORY_CODE_HURRICANE IS NULL THEN 'No' else TERRITORY_CODE_HURRICANE END                         AS TERRITORY_CODE_HURRICANE,
	CASE WHEN STORM_MITIGATION_SHUTTERS IS NULL THEN 'No' else STORM_MITIGATION_SHUTTERS END                       AS STORM_MITIGATION_SHUTTERS,
	CASE WHEN STORM_MITIGATION_IMPACTGLASS IS NULL THEN 'No' else STORM_MITIGATION_IMPACTGLASS END                 AS STORM_MITIGATION_IMPACTGLASS,
	CASE WHEN STORM_MITIGATION_FORTIFIED IS NULL THEN 'No' else STORM_MITIGATION_FORTIFIED END                 	   AS STORM_MITIGATION_FORTIFIED,
	CASE WHEN OFFICER_MAIL_ADDRESS IS NULL THEN 'No' else OFFICER_MAIL_ADDRESS END                                 AS OFFICER_MAIL_ADDRESS,
	CASE WHEN OFFICER_FIRST_NAME IS NULL THEN 'No' else OFFICER_FIRST_NAME END                                     AS OFFICER_FIRST_NAME,
	CASE WHEN OFFICER_LAST_NAME IS NULL THEN 'No' else OFFICER_LAST_NAME END                                       AS OFFICER_LAST_NAME,
	CASE WHEN WROUGHT_IRON IS NULL THEN 'No' else WROUGHT_IRON END                                                 AS WROUGHT_IRON,
	CASE WHEN SHORT_TERM_RENTAL_SURCHARGE IS NULL THEN 'No' else SHORT_TERM_RENTAL_SURCHARGE END                   AS SHORT_TERM_RENTAL_SURCHARGE,
	CASE WHEN DAYCARE_ON_PREMISES IS NULL THEN 'No' else DAYCARE_ON_PREMISES END                                   AS DAYCARE_ON_PREMISES,
	CASE WHEN BUSINESS_EMPLOYEES_ON_PREMISES IS NULL THEN 'No' else BUSINESS_EMPLOYEES_ON_PREMISES END             AS BUSINESS_EMPLOYEES_ON_PREMISES,
	CASE WHEN TERRITORY_CODE_FLOODS IS NULL THEN 'No' else TERRITORY_CODE_FLOODS END                               AS TERRITORY_CODE_FLOODS,
	CASE WHEN TERRITORY_CODE_WILD_FIRE IS NULL THEN 'No' else TERRITORY_CODE_WILD_FIRE END                         AS TERRITORY_CODE_WILD_FIRE,
	CASE WHEN SOURCE_OF_HEAT_INSTALLATION IS NULL THEN 'No' else SOURCE_OF_HEAT_INSTALLATION END                   AS SOURCE_OF_HEAT_INSTALLATION,
	CASE WHEN TYPE_OF_FUEL IS NULL THEN 'No' else TYPE_OF_FUEL END                                                 AS TYPE_OF_FUEL,
	CASE WHEN WINDPOOL IS NULL THEN 'No' else WINDPOOL END                                                         AS WINDPOOL,
	CASE WHEN TRAMPOLINE_SAFETY_NET IS NULL THEN 'No' else TRAMPOLINE_SAFETY_NET END                               AS TRAMPOLINE_SAFETY_NET,
	CASE WHEN VACANCY_REASON IS NULL THEN 'No' else VACANCY_REASON END                                             AS VACANCY_REASON,
	CASE WHEN FOUR_FEET_FENCE IS NULL THEN 'No' else FOUR_FEET_FENCE END                                           AS FOUR_FEET_FENCE,
	CASE WHEN DIVING_BOARD IS NULL THEN 'No' else DIVING_BOARD END                                                 AS DIVING_BOARD,
	CASE WHEN VISITORS_IN_A_MONTH IS NULL THEN 'No' else VISITORS_IN_A_MONTH END                                   AS VISITORS_IN_A_MONTH,
	CASE WHEN HOME_HUD_NUMBER IS NULL THEN 'No' else HOME_HUD_NUMBER END                                           AS HOME_HUD_NUMBER,
	CASE WHEN SKIRTING_TYPE IS NULL THEN 'No' else SKIRTING_TYPE END                                               AS SKIRTING_TYPE
FROM {{ ref('EXPOSURE_CHARACTERISTICS_FIELDS_FLATTEN_STAGE1') }}
