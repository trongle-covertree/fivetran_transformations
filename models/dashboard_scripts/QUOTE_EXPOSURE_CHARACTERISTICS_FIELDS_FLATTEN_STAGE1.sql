{{ config(materialized='table') }}

SELECT 
	QUOTE_EXPOSURE_CHARACTERISTICS_LOCATOR,
	b.POLICY_LOCATOR,
	MAX(CASE WHEN FIELD_NAME = 'country' AND PARENT_NAME <>'additional_interest' THEN FIELD_VALUE END) AS COUNTRY,
	MAX(CASE WHEN FIELD_NAME = 'state' AND PARENT_NAME <>'additional_interest' THEN FIELD_VALUE END) AS STATE,
	MAX(CASE WHEN FIELD_NAME = 'street_address' AND PARENT_NAME <>'additional_interest'  THEN FIELD_VALUE END) AS STREET_ADDRESS,
	MAX(CASE WHEN FIELD_NAME = 'zip_code' AND PARENT_NAME <>'additional_interest'  THEN FIELD_VALUE END) AS ZIP_CODE,
	MAX(CASE WHEN FIELD_NAME = 'city' AND PARENT_NAME <>'additional_interest'  THEN FIELD_VALUE END) AS CITY,
	MAX(CASE WHEN FIELD_NAME = 'county' AND PARENT_NAME <>'additional_interest'  THEN FIELD_VALUE END) AS COUNTY,
	MAX(CASE WHEN FIELD_NAME = 'territory' AND PARENT_NAME <>'additional_interest'  THEN FIELD_VALUE END) AS TERRITORY,
	MAX(CASE WHEN FIELD_NAME = 'long' THEN FIELD_VALUE END) AS LONG,
	MAX(CASE WHEN FIELD_NAME = 'territory_code_aop' THEN FIELD_VALUE END) AS TERRITORY_CODE_AOP,
	MAX(CASE WHEN FIELD_NAME = 'property_with_fire_protection' THEN FIELD_VALUE END) AS PROPERTY_WITH_FIRE_PROTECTION,
	MAX(CASE WHEN FIELD_NAME = 'policy_usage' THEN FIELD_VALUE END) AS POLICY_USAGE,
	MAX(CASE WHEN FIELD_NAME = 'territory_code_windhail' THEN FIELD_VALUE END) AS TERRITORY_CODE_WINDHAIL,
	MAX(CASE WHEN FIELD_NAME = 'lat' THEN FIELD_VALUE END) AS LAT,
	MAX(CASE WHEN FIELD_NAME = 'territory_code_earthquake' THEN FIELD_VALUE END) AS TERRITORY_CODE_EARTHQUAKE,
	MAX(CASE WHEN FIELD_NAME = 'unit_details' THEN FIELD_VALUE END) AS UNIT_DETAILS,
	MAX(CASE WHEN FIELD_NAME = 'usage' THEN FIELD_VALUE END) AS USAGE,
	MAX(CASE WHEN FIELD_NAME = 'business_on_premises' THEN FIELD_VALUE END) AS BUSINESS_ON_PREMISES,
	MAX(CASE WHEN FIELD_NAME = 'grid_id' THEN FIELD_VALUE END) AS GRID_ID,
	MAX(CASE WHEN FIELD_NAME = 'uw_admitted' THEN FIELD_VALUE END) AS UW_ADMITTED,
	MAX(CASE WHEN FIELD_NAME = 'form' THEN FIELD_VALUE END) AS FORM,
	MAX(CASE WHEN FIELD_NAME = 'unit_level_suppl_uw' THEN FIELD_VALUE END) AS UNIT_LEVEL_SUPPL_UW,
	MAX(CASE WHEN FIELD_NAME = 'valuation_id' THEN FIELD_VALUE END) AS VALUATION_ID,
	MAX(CASE WHEN FIELD_NAME = 'unit_address' THEN FIELD_VALUE END) AS UNIT_ADDRESS,
	MAX(CASE WHEN FIELD_NAME = 'unit_id' THEN FIELD_VALUE END) AS UNIT_ID,
	MAX(CASE WHEN FIELD_NAME = 'community_policy_discount' THEN FIELD_VALUE END) AS COMMUNITY_POLICY_DISCOUNT,
	MAX(CASE WHEN FIELD_NAME = 'unit_location' THEN FIELD_VALUE END) AS UNIT_LOCATION,
	MAX(CASE WHEN FIELD_NAME = 'loc_code' THEN FIELD_VALUE END) AS LOC_CODE,
	MAX(CASE WHEN FIELD_NAME = 'personalized_plan_type' THEN FIELD_VALUE END) AS PERSONALIZED_PLAN_TYPE,
	MAX(CASE WHEN FIELD_NAME = 'unit_construction' THEN FIELD_VALUE END) AS UNIT_CONSTRUCTION,
	MAX(CASE WHEN FIELD_NAME = 'home_type' THEN FIELD_VALUE END) AS HOME_TYPE,
	MAX(CASE WHEN FIELD_NAME = 'roof_shape' THEN FIELD_VALUE END) AS ROOF_SHAPE,
	MAX(CASE WHEN FIELD_NAME = 'source_of_heat' THEN FIELD_VALUE END) AS SOURCE_OF_HEAT,
	MAX(CASE WHEN FIELD_NAME = 'roof_condition' THEN FIELD_VALUE END) AS ROOF_CONDITION,
	MAX(CASE WHEN FIELD_NAME = 'model_year' THEN FIELD_VALUE END) AS MODEL_YEAR,
	MAX(CASE WHEN FIELD_NAME = 'rcv' THEN FIELD_VALUE END) AS RCV,
	MAX(CASE WHEN FIELD_NAME = 'swimming_pool' THEN FIELD_VALUE END) AS SWIMMING_POOL,
	MAX(CASE WHEN FIELD_NAME = 'mortgage' THEN FIELD_VALUE END) AS MORTGAGE,
	MAX(CASE WHEN FIELD_NAME = 'manufacturer_name' THEN FIELD_VALUE END) AS MANUFACTURER_NAME,
	MAX(CASE WHEN FIELD_NAME = 'total_square_footage' THEN FIELD_VALUE END) AS TOTAL_SQUARE_FOOTAGE,
	MAX(CASE WHEN FIELD_NAME = 'unrepaired_damages' THEN FIELD_VALUE END) AS UNREPAIRED_DAMAGES,
	MAX(CASE WHEN FIELD_NAME = 'trampoline_liability' THEN FIELD_VALUE END) AS TRAMPOLINE_LIABILITY,
	MAX(CASE WHEN FIELD_NAME = 'exterior' THEN FIELD_VALUE END) AS EXTERIOR,
	MAX(CASE WHEN FIELD_NAME = 'roof_year_yyyy' THEN FIELD_VALUE END) AS ROOF_YEAR_YYYY,
	MAX(CASE WHEN FIELD_NAME = 'secure_rails' THEN FIELD_VALUE END) AS SECURE_RAILS,
	MAX(CASE WHEN FIELD_NAME = 'interior' THEN FIELD_VALUE END) AS INTERIOR,
	MAX(CASE WHEN FIELD_NAME = 'acv' THEN FIELD_VALUE END) AS ACV,
	MAX(CASE WHEN FIELD_NAME = 'utility_services' THEN FIELD_VALUE END) AS UTILITY_SERVICES,
	MAX(CASE WHEN FIELD_NAME = 'inspections' THEN FIELD_VALUE END) AS INSPECTIONS,
	MAX(CASE WHEN FIELD_NAME = 'thermo_static_control' THEN FIELD_VALUE END) AS THERMO_STATIC_CONTROL,
	MAX(CASE WHEN FIELD_NAME = 'unit_is_tied' THEN FIELD_VALUE END) AS UNIT_IS_TIED,
	MAX(CASE WHEN FIELD_NAME = 'aerial' THEN FIELD_VALUE END) AS AERIAL,
	MAX(CASE WHEN FIELD_NAME = 'home_fixtures' THEN FIELD_VALUE END) AS HOME_FIXTURES,
	MAX(CASE WHEN FIELD_NAME = 'roof_material' THEN FIELD_VALUE END) AS ROOF_MATERIAL,
	MAX(CASE WHEN FIELD_NAME = 'county_fips' THEN FIELD_VALUE END) AS COUNTY_FIPS,
	MAX(CASE WHEN FIELD_NAME = 'unusual_risk' THEN FIELD_VALUE END) AS UNUSUAL_RISK,
	MAX(CASE WHEN FIELD_NAME = 'distance_to_coast' THEN FIELD_VALUE END) AS DISTANCE_TO_COAST,
	MAX(CASE WHEN FIELD_NAME = 'rcv_360value' THEN FIELD_VALUE END) AS RCV_360VALUE,
	MAX(CASE WHEN FIELD_NAME = 'park_name' THEN FIELD_VALUE END) AS PARK_NAME,
	MAX(CASE WHEN FIELD_NAME = 'lot_unit' AND PARENT_NAME <>'additional_interest' THEN FIELD_VALUE END) AS LOT_UNIT,
	MAX(CASE WHEN FIELD_NAME = 'purchase_date' THEN FIELD_VALUE END) AS PURCHASE_DATE,
	MAX(CASE WHEN FIELD_NAME = 'ct_mhcid' THEN FIELD_VALUE END) AS CT_MHCID,
	MAX(CASE WHEN FIELD_NAME = 'additional_interest' THEN FIELD_VALUE END) AS ADDITIONAL_INTEREST,
	MAX(CASE WHEN FIELD_NAME = 'name' AND PARENT_NAME <>'additional_interest' THEN FIELD_VALUE END) AS NAME,
	MAX(CASE WHEN FIELD_NAME = 'type' AND PARENT_NAME <>'additional_interest' THEN FIELD_VALUE END) AS TYPE,
	MAX(CASE WHEN FIELD_NAME = 'additional_interest_id' THEN FIELD_VALUE END) AS ADDITIONAL_INTEREST_ID,
	MAX(CASE WHEN FIELD_NAME = 'roof_rating_image_link' THEN FIELD_VALUE END) AS ROOF_RATING_IMAGE_LINK,
	MAX(CASE WHEN FIELD_NAME = 'account_number' AND PARENT_NAME <>'additional_interest' THEN FIELD_VALUE END) AS ACCOUNT_NUMBER,
	MAX(CASE WHEN FIELD_NAME = 'burglar_alarm' THEN FIELD_VALUE END) AS BURGLAR_ALARM,
	MAX(CASE WHEN FIELD_NAME = 'territory_code_hurricane' THEN FIELD_VALUE END) AS TERRITORY_CODE_HURRICANE,
	MAX(CASE WHEN FIELD_NAME = 'storm_mitigation_shutters' THEN FIELD_VALUE END) AS STORM_MITIGATION_SHUTTERS,
	MAX(CASE WHEN FIELD_NAME = 'storm_mitigation_impactglass' THEN FIELD_VALUE END) AS STORM_MITIGATION_IMPACTGLASS,
	MAX(CASE WHEN FIELD_NAME = 'officer_mail_address' AND PARENT_NAME <>'additional_interest' THEN FIELD_VALUE END) AS OFFICER_MAIL_ADDRESS,
	MAX(CASE WHEN FIELD_NAME = 'officer_first_name' AND PARENT_NAME <>'additional_interest' THEN FIELD_VALUE END) AS OFFICER_FIRST_NAME,
	MAX(CASE WHEN FIELD_NAME = 'officer_last_name' AND PARENT_NAME <>'additional_interest' THEN FIELD_VALUE END) AS OFFICER_LAST_NAME,
	MAX(CASE WHEN FIELD_NAME = 'wrought_iron' THEN FIELD_VALUE END) AS WROUGHT_IRON,
	MAX(CASE WHEN FIELD_NAME = 'short_term_rental_surcharge' THEN FIELD_VALUE END) AS SHORT_TERM_RENTAL_SURCHARGE,
	MAX(CASE WHEN FIELD_NAME = 'daycare_on_premises' THEN FIELD_VALUE END) AS DAYCARE_ON_PREMISES,
	MAX(CASE WHEN FIELD_NAME = 'business_employees_on_premises' THEN FIELD_VALUE END) AS BUSINESS_EMPLOYEES_ON_PREMISES,
	MAX(CASE WHEN FIELD_NAME = 'territory_code_floods' THEN FIELD_VALUE END) AS TERRITORY_CODE_FLOODS,
	MAX(CASE WHEN FIELD_NAME = 'territory_code_wild_fire' THEN FIELD_VALUE END) AS TERRITORY_CODE_WILD_FIRE,
	MAX(CASE WHEN FIELD_NAME = 'source_of_heat_installation' THEN FIELD_VALUE END) AS SOURCE_OF_HEAT_INSTALLATION,
	MAX(CASE WHEN FIELD_NAME = 'type_of_fuel' THEN FIELD_VALUE END) AS TYPE_OF_FUEL,
	MAX(CASE WHEN FIELD_NAME = 'windpool' THEN FIELD_VALUE END) AS WINDPOOL,
	MAX(CASE WHEN FIELD_NAME = 'trampoline_safety_net' THEN FIELD_VALUE END) AS TRAMPOLINE_SAFETY_NET,
	MAX(CASE WHEN FIELD_NAME = 'vacancy_reason' THEN FIELD_VALUE END) AS VACANCY_REASON,
	MAX(CASE WHEN FIELD_NAME = 'four_feet_fence' THEN FIELD_VALUE END) AS FOUR_FEET_FENCE,
	MAX(CASE WHEN FIELD_NAME = 'diving_board' THEN FIELD_VALUE END) AS DIVING_BOARD,
	MAX(CASE WHEN FIELD_NAME = 'visitors_in_a_month' THEN FIELD_VALUE END) AS VISITORS_IN_A_MONTH,
	MAX(CASE WHEN FIELD_NAME = 'home_hud_number' THEN FIELD_VALUE END) AS HOME_HUD_NUMBER,
	MAX(CASE WHEN FIELD_NAME = 'skirting_type' THEN FIELD_VALUE END) AS SKIRTING_TYPE
FROM
	MYSQL_DATA_MART_10001.QUOTE_EXPOSURE_CHARACTERISTICS_FIELDS a
LEFT JOIN MYSQL_DATA_MART_10001.QUOTE_EXPOSURE_CHARACTERISTICS b
ON a.QUOTE_EXPOSURE_CHARACTERISTICS_LOCATOR =b."LOCATOR" 
GROUP BY
	1,2